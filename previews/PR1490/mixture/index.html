<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mixture Models · Distributions.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Distributions.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Distributions.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Distributions Package</a></li><li><a class="tocitem" href="../starting/">Getting Started</a></li><li><a class="tocitem" href="../types/">Type Hierarchy</a></li><li><a class="tocitem" href="../univariate/">Univariate Distributions</a></li><li><a class="tocitem" href="../truncate/">Truncated Distributions</a></li><li><a class="tocitem" href="../censored/">Censored Distributions</a></li><li><a class="tocitem" href="../multivariate/">Multivariate Distributions</a></li><li><a class="tocitem" href="../matrix/">Matrix-variate Distributions</a></li><li><a class="tocitem" href="../reshape/">Reshaping distributions</a></li><li><a class="tocitem" href="../cholesky/">Cholesky-variate Distributions</a></li><li class="is-active"><a class="tocitem" href>Mixture Models</a><ul class="internal"><li><a class="tocitem" href="#Type-Hierarchy"><span>Type Hierarchy</span></a></li><li><a class="tocitem" href="#Constructors"><span>Constructors</span></a></li><li><a class="tocitem" href="#Common-Interface"><span>Common Interface</span></a></li><li><a class="tocitem" href="#Estimation"><span>Estimation</span></a></li></ul></li><li><a class="tocitem" href="../convolution/">Convolutions</a></li><li><a class="tocitem" href="../fit/">Distribution Fitting</a></li><li><a class="tocitem" href="../extends/">Create New Samplers and Distributions</a></li><li><a class="tocitem" href="../density_interface/">Support for DensityInterface</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mixture Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mixture Models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaStats/Distributions.jl/blob/master/docs/src/mixture.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Mixture-Models"><a class="docs-heading-anchor" href="#Mixture-Models">Mixture Models</a><a id="Mixture-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Mixture-Models" title="Permalink"></a></h1><p>A <a href="http://en.wikipedia.org/wiki/Mixture_model">mixture model</a> is a probabilistic distribution that combines a set of <em>component</em> to represent the overall distribution. Generally, the probability density/mass function is given by a convex combination of the pdf/pmf of individual components, as</p><p class="math-container">\[f_{mix}(x; \Theta, \pi) = \sum_{k=1}^K \pi_k f(x; \theta_k)\]</p><p>A <em>mixture model</em> is characterized by a set of component parameters <span>$\Theta=\{\theta_1, \ldots, \theta_K\}$</span> and a prior distribution <span>$\pi$</span> over these components.</p><h2 id="Type-Hierarchy"><a class="docs-heading-anchor" href="#Type-Hierarchy">Type Hierarchy</a><a id="Type-Hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Hierarchy" title="Permalink"></a></h2><p>This package introduces a type <code>MixtureModel</code>, defined as follows, to represent a <em>mixture model</em>:</p><pre><code class="language-julia hljs">abstract type AbstractMixtureModel{VF&lt;:VariateForm,VS&lt;:ValueSupport} &lt;: Distribution{VF, VS} end

struct MixtureModel{VF&lt;:VariateForm,VS&lt;:ValueSupport,Component&lt;:Distribution} &lt;: AbstractMixtureModel{VF,VS}
    components::Vector{Component}
    prior::Categorical
end

const UnivariateMixture    = AbstractMixtureModel{Univariate}
const MultivariateMixture  = AbstractMixtureModel{Multivariate}</code></pre><p><strong>Remarks:</strong></p><ul><li>We introduce <code>AbstractMixtureModel</code> as a base type, which allows one to define a mixture model with different internal implementation, while still being able to leverage the common methods defined for <code>AbstractMixtureModel</code>.</li></ul><article class="docstring"><header><a class="docstring-binding" id="Distributions.AbstractMixtureModel" href="#Distributions.AbstractMixtureModel"><code>Distributions.AbstractMixtureModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>All subtypes of <code>AbstractMixtureModel</code> should implement the following methods:</p><ul><li><p>ncomponents(d): the number of components</p></li><li><p>component(d, k):  return the k-th component</p></li><li><p>probs(d):       return a vector of prior probabilities over components.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L3-L12">source</a></section></article><ul><li><p>The <code>MixtureModel</code> is a parametric type, with three type parameters:</p><ul><li><code>VF</code>: the variate form, which can be <code>Univariate</code>, <code>Multivariate</code>, or <code>Matrixvariate</code>.</li><li><code>VS</code>: the value support, which can be <code>Continuous</code> or <code>Discrete</code>.</li><li><code>Component</code>: the type of component distributions, <em>e.g.</em> <code>Normal</code>.</li></ul></li><li><p>We define two aliases: <code>UnivariateMixture</code> and <code>MultivariateMixture</code>.</p></li></ul><p>With such a type system, the type for a mixture of univariate normal distributions can be written as</p><pre><code class="language-julia hljs">MixtureModel{Univariate,Continuous,Normal}</code></pre><h2 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Distributions.MixtureModel" href="#Distributions.MixtureModel"><code>Distributions.MixtureModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>MixtureModel{VF&lt;:VariateForm,VS&lt;:ValueSupport,C&lt;:Distribution,CT&lt;:Real} A mixture of distributions, parametrized on:</p><ul><li><code>VF,VS</code> variate and support</li><li><code>C</code> distribution family of the mixture</li><li><code>CT</code> the type for probabilities of the prior</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L15-L21">source</a></section></article><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># constructs a mixture of three normal distributions,
# with prior probabilities [0.2, 0.5, 0.3]
MixtureModel(Normal[
   Normal(-2.0, 1.2),
   Normal(0.0, 1.0),
   Normal(3.0, 2.5)], [0.2, 0.5, 0.3])

# if the components share the same prior, the prior vector can be omitted
MixtureModel(Normal[
   Normal(-2.0, 1.2),
   Normal(0.0, 1.0),
   Normal(3.0, 2.5)])

# Since all components have the same type, we can use a simplified syntax
MixtureModel(Normal, [(-2.0, 1.2), (0.0, 1.0), (3.0, 2.5)], [0.2, 0.5, 0.3])

# Again, one can omit the prior vector when all components share the same prior
MixtureModel(Normal, [(-2.0, 1.2), (0.0, 1.0), (3.0, 2.5)])

# The following example shows how one can make a Gaussian mixture
# where all components share the same unit variance
MixtureModel(map(u -&gt; Normal(u, 1.0), [-2.0, 0.0, 3.0]))</code></pre><h2 id="Common-Interface"><a class="docs-heading-anchor" href="#Common-Interface">Common Interface</a><a id="Common-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Interface" title="Permalink"></a></h2><p>All subtypes of <code>AbstractMixtureModel</code> (obviously including <code>MixtureModel</code>) provide the following two methods:</p><article class="docstring"><header><a class="docstring-binding" id="Distributions.components-Tuple{AbstractMixtureModel}" href="#Distributions.components-Tuple{AbstractMixtureModel}"><code>Distributions.components</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">components(d::AbstractMixtureModel)</code></pre><p>Get a list of components of the mixture model <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Distributions.probs-Tuple{AbstractMixtureModel}" href="#Distributions.probs-Tuple{AbstractMixtureModel}"><code>Distributions.probs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">probs(d::AbstractMixtureModel)</code></pre><p>Get the vector of prior probabilities of all components of <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Distributions.component_type-Tuple{AbstractMixtureModel}" href="#Distributions.component_type-Tuple{AbstractMixtureModel}"><code>Distributions.component_type</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">component_type(d::AbstractMixtureModel)</code></pre><p>The type of the components of <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L39-L43">source</a></section></article><p>In addition, for all subtypes of <code>UnivariateMixture</code> and <code>MultivariateMixture</code>, the following generic methods are provided:</p><article class="docstring"><header><a class="docstring-binding" id="Statistics.mean-Tuple{AbstractMixtureModel}" href="#Statistics.mean-Tuple{AbstractMixtureModel}"><code>Statistics.mean</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mean(d::Union{UnivariateMixture, MultivariateMixture})</code></pre><p>Compute the overall mean (expectation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Statistics.var-Tuple{UnivariateMixture}" href="#Statistics.var-Tuple{UnivariateMixture}"><code>Statistics.var</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">var(d::UnivariateMixture)</code></pre><p>Compute the overall variance (only for <span>$UnivariateMixture$</span>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L193-L197">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{MultivariateMixture}" href="#Base.length-Tuple{MultivariateMixture}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">length(d::MultivariateMixture)</code></pre><p>The length of each sample (only for <code>Multivariate</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Distributions.pdf-Tuple{AbstractMixtureModel, Any}" href="#Distributions.pdf-Tuple{AbstractMixtureModel, Any}"><code>Distributions.pdf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pdf(d::Union{UnivariateMixture, MultivariateMixture}, x)</code></pre><p>Evaluate the (mixed) probability density function over <code>x</code>. Here, <code>x</code> can be a single sample or an array of multiple samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Distributions.logpdf-Tuple{AbstractMixtureModel, Any}" href="#Distributions.logpdf-Tuple{AbstractMixtureModel, Any}"><code>Distributions.logpdf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">logpdf(d::Union{UnivariateMixture, MultivariateMixture}, x)</code></pre><p>Evaluate the logarithm of the (mixed) probability density function over <code>x</code>. Here, <code>x</code> can be a single sample or an array of multiple samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L82-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.rand-Tuple{AbstractMixtureModel}" href="#Base.rand-Tuple{AbstractMixtureModel}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand(d::Union{UnivariateMixture, MultivariateMixture})</code></pre><p>Draw a sample from the mixture model <code>d</code>.</p><pre><code class="nohighlight hljs">rand(d::Union{UnivariateMixture, MultivariateMixture}, n)</code></pre><p>Draw <code>n</code> samples from <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L90-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Random.rand!-Tuple{AbstractMixtureModel, AbstractArray}" href="#Random.rand!-Tuple{AbstractMixtureModel, AbstractArray}"><code>Random.rand!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand!(d::Union{UnivariateMixture, MultivariateMixture}, r::AbstractArray)</code></pre><p>Draw multiple samples from <code>d</code> and write them to <code>r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/86e99b844dd603709ed7ddf3ef5246a959dfaa6b/src/mixtures/mixturemodel.jl#L101-L105">source</a></section></article><h2 id="Estimation"><a class="docs-heading-anchor" href="#Estimation">Estimation</a><a id="Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation" title="Permalink"></a></h2><p>There are a number of methods for estimating of mixture models from data, and this problem remains an open research topic. This package does not provide facilities for estimating mixture models. One can resort to other packages, <em>e.g.</em> <a href="https://github.com/davidavdav/GaussianMixtures.jl"><em>GaussianMixtures.jl</em></a>, for this purpose.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cholesky/">« Cholesky-variate Distributions</a><a class="docs-footer-nextpage" href="../convolution/">Convolutions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Monday 18 April 2022 09:25">Monday 18 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
