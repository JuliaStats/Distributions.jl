<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mixture Models · Distributions.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Distributions.jl logo"/></a><h1>Distributions.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Distributions Package</a></li><li><a class="toctext" href="../starting/">Getting Started</a></li><li><a class="toctext" href="../types/">Type Hierarchy</a></li><li><a class="toctext" href="../univariate/">Univariate Distributions</a></li><li><a class="toctext" href="../truncate/">Truncated Distributions</a></li><li><a class="toctext" href="../multivariate/">Multivariate Distributions</a></li><li><a class="toctext" href="../matrix/">Matrix-variate Distributions</a></li><li class="current"><a class="toctext" href>Mixture Models</a><ul class="internal"><li><a class="toctext" href="#Type-Hierarchy-1">Type Hierarchy</a></li><li><a class="toctext" href="#Constructors-1">Constructors</a></li><li><a class="toctext" href="#Common-Interface-1">Common Interface</a></li><li><a class="toctext" href="#Estimation-1">Estimation</a></li></ul></li><li><a class="toctext" href="../fit/">Distribution Fitting</a></li><li><a class="toctext" href="../extends/">Create New Samplers and Distributions</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Mixture Models</a></li></ul><a class="edit-page" href="https://github.com/JuliaStats/Distributions.jl/blob/master/docs/src/mixture.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Mixture Models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Mixture-Models-1" href="#Mixture-Models-1">Mixture Models</a></h1><p>A <a href="http://en.wikipedia.org/wiki/Mixture_model">mixture model</a> is a probabilistic distribution that combines a set of <em>component</em> to represent the overall distribution. Generally, the probability density/mass function is given by a convex combination of the pdf/pmf of individual components, as</p><div>\[f_{mix}(x; \Theta, \pi) = \sum_{k=1}^K \pi_k f(x; \theta_k)\]</div><p>A <em>mixture model</em> is characterized by a set of component parameters <span>$\Theta=\{\theta_1, \ldots, \theta_K\}$</span> and a prior distribution <span>$\pi$</span> over these components.</p><h2><a class="nav-anchor" id="Type-Hierarchy-1" href="#Type-Hierarchy-1">Type Hierarchy</a></h2><p>This package introduces a type <code>MixtureModel</code>, defined as follows, to represent a <em>mixture model</em>:</p><pre><code class="language-julia">abstract type AbstractMixtureModel{VF&lt;:VariateForm,VS&lt;:ValueSupport} &lt;: Distribution{VF, VS} end

struct MixtureModel{VF&lt;:VariateForm,VS&lt;:ValueSupport,Component&lt;:Distribution} &lt;: AbstractMixtureModel{VF,VS}
    components::Vector{Component}
    prior::Categorical
end

const UnivariateMixture    = AbstractMixtureModel{Univariate}
const MultivariateMixture  = AbstractMixtureModel{Multivariate}</code></pre><p><strong>Remarks:</strong></p><ul><li>We introduce <code>AbstractMixtureModel</code> as a base type, which allows one to define a mixture model with different internal implementation, while still being able to leverage the common methods defined for <code>AbstractMixtureModel</code>.</li></ul><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.AbstractMixtureModel" href="#Distributions.AbstractMixtureModel"><code>Distributions.AbstractMixtureModel</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>All subtypes of <code>AbstractMixtureModel</code> should implement the following methods:</p><ul><li><p>ncomponents(d): the number of components</p></li><li><p>component(d, k):  return the k-th component</p></li><li><p>probs(d):       return a vector of prior probabilities over components.</p></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L3-L12">source</a></section><ul><li><p>The <code>MixtureModel</code> is a parametric type, with three type parameters:</p><ul><li><code>VF</code>: the variate form, which can be <code>Univariate</code>, <code>Multivariate</code>, or <code>Matrixvariate</code>.</li><li><code>VS</code>: the value support, which can be <code>Continuous</code> or <code>Discrete</code>.</li><li><code>Component</code>: the type of component distributions, <em>e.g.</em> <code>Normal</code>.</li></ul></li><li><p>We define two aliases: <code>UnivariateMixture</code> and <code>MultivariateMixture</code>.</p></li></ul><p>With such a type system, the type for a mixture of univariate normal distributions can be written as</p><pre><code class="language-julia">MixtureModel{Univariate,Continuous,Normal}</code></pre><h2><a class="nav-anchor" id="Constructors-1" href="#Constructors-1">Constructors</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.MixtureModel" href="#Distributions.MixtureModel"><code>Distributions.MixtureModel</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>MixtureModel{VF&lt;:VariateForm,VS&lt;:ValueSupport,C&lt;:Distribution,CT&lt;:Real} A mixture of distributions, parametrized on:</p><ul><li><code>VF,VS</code> variate and support</li><li><code>C</code> distribution family of the mixture</li><li><code>CT</code> the type for probabilities of the prior</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L15-L21">source</a></section><p><strong>Examples</strong></p><pre><code class="language-julia"># constructs a mixture of three normal distributions,
# with prior probabilities [0.2, 0.5, 0.3]
MixtureModel(Normal[
   Normal(-2.0, 1.2),
   Normal(0.0, 1.0),
   Normal(3.0, 2.5)], [0.2, 0.5, 0.3])

# if the components share the same prior, the prior vector can be omitted
MixtureModel(Normal[
   Normal(-2.0, 1.2),
   Normal(0.0, 1.0),
   Normal(3.0, 2.5)])

# Since all components have the same type, we can use a simplified syntax
MixtureModel(Normal, [(-2.0, 1.2), (0.0, 1.0), (3.0, 2.5)], [0.2, 0.5, 0.3])

# Again, one can omit the prior vector when all components share the same prior
MixtureModel(Normal, [(-2.0, 1.2), (0.0, 1.0), (3.0, 2.5)])

# The following example shows how one can make a Gaussian mixture
# where all components share the same unit variance
MixtureModel(map(u -&gt; Normal(u, 1.0), [-2.0, 0.0, 3.0]))</code></pre><h2><a class="nav-anchor" id="Common-Interface-1" href="#Common-Interface-1">Common Interface</a></h2><p>All subtypes of <code>AbstractMixtureModel</code> (obviously including <code>MixtureModel</code>) provide the following two methods:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.components-Tuple{AbstractMixtureModel}" href="#Distributions.components-Tuple{AbstractMixtureModel}"><code>Distributions.components</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">components(d::AbstractMixtureModel)</code></pre><p>Get a list of components of the mixture model <code>d</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L46-L50">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.probs-Tuple{AbstractMixtureModel}" href="#Distributions.probs-Tuple{AbstractMixtureModel}"><code>Distributions.probs</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">probs(d::AbstractMixtureModel)</code></pre><p>Get the vector of prior probabilities of all components of <code>d</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L53-L57">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.component_type-Tuple{AbstractMixtureModel}" href="#Distributions.component_type-Tuple{AbstractMixtureModel}"><code>Distributions.component_type</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">component_type(d::AbstractMixtureModel)</code></pre><p>The type of the components of <code>d</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L39-L43">source</a></section><p>In addition, for all subtypes of <code>UnivariateMixture</code> and <code>MultivariateMixture</code>, the following generic methods are provided:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Statistics.mean-Tuple{AbstractMixtureModel}" href="#Statistics.mean-Tuple{AbstractMixtureModel}"><code>Statistics.mean</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">mean(d::Union{UnivariateMixture, MultivariateMixture})</code></pre><p>Compute the overall mean (expectation).</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L60-L64">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Statistics.var-Tuple{AbstractMixtureModel{Univariate,S,C} where C&lt;:Distribution where S&lt;:ValueSupport}" href="#Statistics.var-Tuple{AbstractMixtureModel{Univariate,S,C} where C&lt;:Distribution where S&lt;:ValueSupport}"><code>Statistics.var</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">var(d::UnivariateMixture)</code></pre><p>Compute the overall variance (only for <span>$UnivariateMixture$</span>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L201-L205">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.length-Tuple{AbstractMixtureModel{Multivariate,S,C} where C&lt;:Distribution where S&lt;:ValueSupport}" href="#Base.length-Tuple{AbstractMixtureModel{Multivariate,S,C} where C&lt;:Distribution where S&lt;:ValueSupport}"><code>Base.length</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">length(d::MultivariateMixture)</code></pre><p>The length of each sample (only for <code>Multivariate</code>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L154-L158">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.pdf-Tuple{AbstractMixtureModel,Any}" href="#Distributions.pdf-Tuple{AbstractMixtureModel,Any}"><code>Distributions.pdf</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">pdf(d::Union{UnivariateMixture, MultivariateMixture}, x)</code></pre><p>Evaluate the (mixed) probability density function over <code>x</code>. Here, <code>x</code> can be a single sample or an array of multiple samples.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L74-L79">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Distributions.logpdf-Tuple{AbstractMixtureModel,Any}" href="#Distributions.logpdf-Tuple{AbstractMixtureModel,Any}"><code>Distributions.logpdf</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">logpdf(d::Union{UnivariateMixture, MultivariateMixture}, x)</code></pre><p>Evaluate the logarithm of the (mixed) probability density function over <code>x</code>. Here, <code>x</code> can be a single sample or an array of multiple samples.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L82-L87">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.rand-Tuple{AbstractMixtureModel}" href="#Base.rand-Tuple{AbstractMixtureModel}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">rand(d::Union{UnivariateMixture, MultivariateMixture})</code></pre><p>Draw a sample from the mixture model <code>d</code>.</p><pre><code class="language-none">rand(d::Union{UnivariateMixture, MultivariateMixture}, n)</code></pre><p>Draw <code>n</code> samples from <code>d</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L90-L98">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Random.rand!-Tuple{AbstractMixtureModel,AbstractArray}" href="#Random.rand!-Tuple{AbstractMixtureModel,AbstractArray}"><code>Random.rand!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">rand!(d::Union{UnivariateMixture, MultivariateMixture}, r::AbstactArray)</code></pre><p>Draw multiple samples from <code>d</code> and write them to <code>r</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaStats/Distributions.jl/blob/20c91d9efcc5f96913bf8e38be2e3fb14b21942b/src/mixtures/mixturemodel.jl#L101-L105">source</a></section><h2><a class="nav-anchor" id="Estimation-1" href="#Estimation-1">Estimation</a></h2><p>There are a number of methods for estimating of mixture models from data, and this problem remains an open research topic. This package does not provide facilities for estimating mixture models. One can resort to other packages, <em>e.g.</em> <a href="https://github.com/davidavdav/GaussianMixtures.jl"><em>GaussianMixtures.jl</em></a>, for this purpose.</p><footer><hr/><a class="previous" href="../matrix/"><span class="direction">Previous</span><span class="title">Matrix-variate Distributions</span></a><a class="next" href="../fit/"><span class="direction">Next</span><span class="title">Distribution Fitting</span></a></footer></article></body></html>
